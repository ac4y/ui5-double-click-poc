<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>UI5 Double-Click Demo - M≈±k√∂dik!</title>
    <style>
        /* Splash Screen */
        #splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease-out;
        }

        #splash-screen.loaded {
            opacity: 0;
            pointer-events: none;
        }

        .splash-content {
            text-align: center;
            color: white;
        }

        .splash-title {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 1rem;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .splash-subtitle {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            opacity: 0.9;
        }

        .loader {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .splash-info {
            margin-top: 2rem;
            font-size: 0.9rem;
            opacity: 0.8;
        }
    </style>
    <script
        id="sap-ui-bootstrap"
        src="https://sapui5.hana.ondemand.com/1.105.0/resources/sap-ui-core.js"
        data-sap-ui-theme="sap_horizon"
        data-sap-ui-libs="sap.m"
        data-sap-ui-async="true"
        data-sap-ui-preload="async">
    </script>
</head>
<body class="sapUiBody">
    <!-- Splash Screen -->
    <div id="splash-screen">
        <div class="splash-content">
            <div class="splash-title">üéØ UI5 Double-Click POC</div>
            <div class="splash-subtitle">Dupla-kattint√°sos v√©dett input mez≈ëk</div>
            <div class="loader"></div>
            <div class="splash-info">UI5 bet√∂lt√©se...</div>
        </div>
    </div>

    <!-- UI5 App Container -->
    <div id="content"></div>

    <script>
        // V√°runk, am√≠g a UI5 bet√∂lt≈ëdik
        (function waitForSap() {
            if (typeof sap !== 'undefined' && sap.ui && sap.ui.getCore) {
                // UI5 inicializ√°l√°s UT√ÅN futtatjuk a k√≥dot
                sap.ui.getCore().attachInit(function() {
            console.log("UI5 Core initialized!");

            // V√°runk, hogy minden bet√∂lt≈ëdj√∂n
            sap.ui.require([
                "sap/m/Page",
                "sap/m/Table",
                "sap/m/Column",
                "sap/m/ColumnListItem",
                "sap/m/Input",
                "sap/m/Text",
                "sap/m/Title",
                "sap/m/VBox",
                "sap/m/MessageToast",
                "sap/ui/model/json/JSONModel"
            ], function(Page, Table, Column, ColumnListItem, Input, Text, Title, VBox, MessageToast, JSONModel) {

                console.log("All UI5 modules loaded!");

                // ========================================
                // DUPLA KATTINT√ÅS KEZEL≈ê LOGIKA
                // ========================================
                var clickTracking = {};
                var clickTimeout = 500;

                function handleInputPress(oEvent) {
                    var oInput = oEvent.getSource();
                    var sInputId = oInput.getId();

                    if (!clickTracking[sInputId]) {
                        clickTracking[sInputId] = { count: 0, timeout: null };
                    }

                    var oTracking = clickTracking[sInputId];
                    if (oTracking.timeout) {
                        clearTimeout(oTracking.timeout);
                    }

                    oTracking.count++;

                    if (oTracking.count === 1) {
                        // ELS≈ê KATTINT√ÅS
                        MessageToast.show("‚úã Els≈ë kattint√°s - kattints m√©g egyszer a szerkeszt√©shez!");
                        oInput.addStyleClass("sapUiHighlight");

                        oTracking.timeout = setTimeout(function() {
                            oTracking.count = 0;
                            oInput.removeStyleClass("sapUiHighlight");
                        }, clickTimeout);

                    } else if (oTracking.count === 2) {
                        // M√ÅSODIK KATTINT√ÅS - SZERKESZTHET≈ê!
                        MessageToast.show("‚úÖ Szerkeszthet≈ë m√≥d aktiv√°lva!");
                        oInput.setEditable(true);
                        oInput.removeStyleClass("sapUiHighlight");
                        oInput.addStyleClass("sapUiEdit");

                        setTimeout(function() {
                            oInput.focus();
                            var oDomRef = oInput.getDomRef("inner");
                            if (oDomRef && oDomRef.select) {
                                oDomRef.select();
                            }
                        }, 50);

                        oTracking.count = 0;
                        clearTimeout(oTracking.timeout);

                        // Blur esem√©nyre vissza√°ll√≠t√°s read-only m√≥dba
                        oInput.attachBrowserEvent("blur", function() {
                            oInput.setEditable(false);
                            oInput.removeStyleClass("sapUiEdit");
                            oInput.detachBrowserEvent("blur");
                            MessageToast.show("üîí Mez≈ë √∫jra v√©dve");
                        });
                    }
                }

                // ========================================
                // ADAT MODELL
                // ========================================
                var oModel = new JSONModel({
                    items: [
                        { name: "Els≈ë elem", value: "100", description: "Dupla kattint√°ssal szerkeszthet≈ë" },
                        { name: "M√°sodik elem", value: "200", description: "V√©dett adat mez≈ë" },
                        { name: "Harmadik elem", value: "300", description: "Pr√≥b√°ld ki a dupla kattint√°st!" },
                        { name: "Negyedik elem", value: "400", description: "500ms timeout van be√°ll√≠tva" }
                    ]
                });

                // ========================================
                // T√ÅBL√ÅZAT L√âTREHOZ√ÅSA
                // ========================================
                var oTable = new Table({
                    headerText: "üîê V√©dett adatok - Kattints k√©tszer az √ârt√©k mez≈ëre a szerkeszt√©shez!",
                    columns: [
                        new Column({
                            header: new Text({ text: "N√©v" }),
                            width: "25%"
                        }),
                        new Column({
                            header: new Text({ text: "‚ö° √ârt√©k (KATTINTS 2x!)" }),
                            width: "25%"
                        }),
                        new Column({
                            header: new Text({ text: "Le√≠r√°s" }),
                            width: "50%"
                        })
                    ]
                });

                oTable.bindItems({
                    path: "/items",
                    template: new ColumnListItem({
                        cells: [
                            new Text({ text: "{name}" }),
                            new Input({
                                value: "{value}",
                                editable: false,
                                width: "100%",
                                press: handleInputPress
                            }),
                            new Text({ text: "{description}" })
                        ]
                    })
                });

                // ========================================
                // OLDAL L√âTREHOZ√ÅSA
                // ========================================
                var oPage = new Page({
                    title: "üéØ UI5 Dupla-Kattint√°sos Input Demo",
                    showHeader: true,
                    content: [
                        new VBox({
                            class: "sapUiMediumMargin",
                            items: [
                                new Title({
                                    text: "üìã Haszn√°lati √∫tmutat√≥:",
                                    level: "H3"
                                }),
                                new Text({
                                    text: "1Ô∏è‚É£ Kattints EGYSZER egy √©rt√©k mez≈ëre ‚Üí Highlight jelenik meg + Toast √ºzenet\n" +
                                          "2Ô∏è‚É£ Kattints M√âG EGYSZER (500ms-en bel√ºl) ‚Üí Mez≈ë szerkeszthet≈ëv√© v√°lik + automatikus f√≥kusz\n" +
                                          "3Ô∏è‚É£ Kattints ki a mez≈ëb≈ël (blur) ‚Üí Automatikusan visszav√°lt read-only m√≥dba",
                                    renderWhitespace: true,
                                    class: "sapUiSmallMarginBottom"
                                }),
                                new Title({
                                    text: "üí° Tipp:",
                                    level: "H4",
                                    class: "sapUiSmallMarginTop"
                                }),
                                new Text({
                                    text: "Ha lassan kattintasz (t√∂bb mint 500ms), akkor √∫jrakezdi a sz√°ml√°l√°st!",
                                    class: "sapUiSmallMarginBottom"
                                }),
                                oTable
                            ]
                        })
                    ]
                });

                oPage.setModel(oModel);

                // Oldal megjelen√≠t√©se
                oPage.placeAt("content");

                // ========================================
                // SPLASH SCREEN ELT√úNTET√âSE
                // ========================================
                setTimeout(function() {
                    console.log("UI ready, hiding splash screen...");
                    document.getElementById("splash-screen").classList.add("loaded");

                    // Splash screen elt√°vol√≠t√°sa 500ms m√∫lva (az anim√°ci√≥ ut√°n)
                    setTimeout(function() {
                        var splash = document.getElementById("splash-screen");
                        if (splash) {
                            splash.remove();
                        }
                    }, 500);

                    // √údv√∂zl≈ë √ºzenet
                    MessageToast.show("üéâ Demo bet√∂ltve! Pr√≥b√°ld ki a dupla kattint√°st az √©rt√©k mez≈ëk√∂n!");
                }, 300);
                });
            });
            } else {
                // √öjra pr√≥b√°lkozunk 50ms m√∫lva
                setTimeout(waitForSap, 50);
            }
        })();
    </script>
</body>
</html>
