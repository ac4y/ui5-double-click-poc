<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>UI5 Double-Click Demo</title>
    <!-- OpenUI5 CDN - Alternat√≠v -->
    <script
        id="sap-ui-bootstrap"
        src="https://sdk.openui5.org/resources/sap-ui-core.js"
        data-sap-ui-theme="sap_horizon"
        data-sap-ui-libs="sap.m"
        data-sap-ui-async="true"
        data-sap-ui-preload="async"
        data-sap-ui-version="1.105.1">
    </script>
</head>
<body class="sapUiBody">
    <!-- UI5 App Container -->
    <div id="content"></div>

    <script>
        // DOMContentLoaded esem√©nyre v√°runk
        document.addEventListener('DOMContentLoaded', function() {
            console.log("DOM loaded!");

            // V√°runk a UI5-re
            (function waitForSap() {
                if (typeof sap !== 'undefined' && sap.ui && sap.ui.getCore) {
                    console.log("SAP object found!");

                    // UI5 Core init
                    sap.ui.getCore().attachInit(function() {
                        console.log("UI5 Core initialized!");

                        // Modulok bet√∂lt√©se
                        sap.ui.require([
                            "sap/m/Page",
                            "sap/m/Table",
                            "sap/m/Column",
                            "sap/m/ColumnListItem",
                            "sap/m/Input",
                            "sap/m/Text",
                            "sap/m/Title",
                            "sap/m/VBox",
                            "sap/m/MessageToast",
                            "sap/ui/model/json/JSONModel"
                        ], function(Page, Table, Column, ColumnListItem, Input, Text, Title, VBox, MessageToast, JSONModel) {

                            console.log("All modules loaded!");

                            // ========================================
                            // DUPLA KATTINT√ÅS KEZEL≈ê LOGIKA
                            // ========================================
                            var clickTracking = {};
                            var clickTimeout = 500;

                            function handleInputPress(oEvent) {
                                var oInput = oEvent.getSource();
                                var sInputId = oInput.getId();

                                if (!clickTracking[sInputId]) {
                                    clickTracking[sInputId] = { count: 0, timeout: null };
                                }

                                var oTracking = clickTracking[sInputId];
                                if (oTracking.timeout) {
                                    clearTimeout(oTracking.timeout);
                                }

                                oTracking.count++;

                                if (oTracking.count === 1) {
                                    // ELS≈ê KATTINT√ÅS
                                    MessageToast.show("‚úã Els≈ë kattint√°s - kattints m√©g egyszer!");
                                    oInput.addStyleClass("sapUiHighlight");

                                    oTracking.timeout = setTimeout(function() {
                                        oTracking.count = 0;
                                        oInput.removeStyleClass("sapUiHighlight");
                                    }, clickTimeout);

                                } else if (oTracking.count === 2) {
                                    // M√ÅSODIK KATTINT√ÅS
                                    MessageToast.show("‚úÖ Szerkeszthet≈ë m√≥d!");
                                    oInput.setEditable(true);
                                    oInput.removeStyleClass("sapUiHighlight");

                                    setTimeout(function() {
                                        oInput.focus();
                                        var oDomRef = oInput.getDomRef("inner");
                                        if (oDomRef && oDomRef.select) {
                                            oDomRef.select();
                                        }
                                    }, 50);

                                    oTracking.count = 0;
                                    clearTimeout(oTracking.timeout);

                                    // Blur -> read-only
                                    oInput.attachBrowserEvent("blur", function() {
                                        oInput.setEditable(false);
                                        MessageToast.show("üîí Mez≈ë v√©dve");
                                    });
                                }
                            }

                            // ADAT MODELL
                            var oModel = new JSONModel({
                                items: [
                                    { name: "Els≈ë elem", value: "100", description: "Dupla kattint√°ssal szerkeszthet≈ë" },
                                    { name: "M√°sodik elem", value: "200", description: "V√©dett adat" },
                                    { name: "Harmadik elem", value: "300", description: "Pr√≥b√°ld ki!" },
                                    { name: "Negyedik elem", value: "400", description: "500ms timeout" }
                                ]
                            });

                            // T√ÅBL√ÅZAT
                            var oTable = new Table({
                                headerText: "üîê V√©dett adatok - Kattints k√©tszer az √ârt√©k mez≈ëre!",
                                columns: [
                                    new Column({ header: new Text({ text: "N√©v" }), width: "25%" }),
                                    new Column({ header: new Text({ text: "‚ö° √ârt√©k (2x KATT!)" }), width: "25%" }),
                                    new Column({ header: new Text({ text: "Le√≠r√°s" }), width: "50%" })
                                ]
                            });

                            oTable.bindItems({
                                path: "/items",
                                template: new ColumnListItem({
                                    cells: [
                                        new Text({ text: "{name}" }),
                                        new Input({
                                            value: "{value}",
                                            editable: false,
                                            width: "100%",
                                            press: handleInputPress
                                        }),
                                        new Text({ text: "{description}" })
                                    ]
                                })
                            });

                            // OLDAL
                            var oPage = new Page({
                                title: "üéØ UI5 Dupla-Kattint√°sos Input Demo",
                                content: [
                                    new VBox({
                                        class: "sapUiMediumMargin",
                                        items: [
                                            new Title({ text: "üìã Haszn√°lat:", level: "H3" }),
                                            new Text({
                                                text: "1Ô∏è‚É£ Kattints EGYSZER ‚Üí Highlight\n" +
                                                      "2Ô∏è‚É£ Kattints M√âG EGYSZER (500ms-en bel√ºl) ‚Üí Szerkeszthet≈ë\n" +
                                                      "3Ô∏è‚É£ Kattints ki ‚Üí Read-only",
                                                renderWhitespace: true,
                                                class: "sapUiSmallMarginBottom"
                                            }),
                                            oTable
                                        ]
                                    })
                                ]
                            });

                            oPage.setModel(oModel);
                            oPage.placeAt("content");

                            // √údv√∂zl≈ë √ºzenet
                            MessageToast.show("üéâ Pr√≥b√°ld ki a dupla kattint√°st!");
                        });
                    });
                } else {
                    setTimeout(waitForSap, 50);
                }
            })();
        });
    </script>
</body>
</html>
